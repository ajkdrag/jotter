/* ============================================
   OTTERLY DESIGN TOKENS — Nordic Minimal
   ============================================
   Extended design system that builds on shadcn-svelte.
   Import this AFTER app.css in your layout.

   Rationale: app.css is managed by shadcn-svelte CLI,
   so we extend and override rather than modify it.
   ============================================ */

:root {
  /* ----------------------------------------
     FONT FAMILY
     ---------------------------------------- */
  --font-family-sans: "Inter", system-ui, -apple-system, sans-serif;
  --font-family-mono:
    "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    monospace;

  /* ----------------------------------------
     ACCENT COLOR: Spruce Green
     ----------------------------------------
     A refined forest/spruce green that evokes
     Nordic landscapes — richer than the muted
     forest tone, warmer than teal.
     ---------------------------------------- */
  --accent-hue: 155;
  --accent-chroma: 0.11;

  /* ----------------------------------------
     SPRUCE SCALE (50-900)
     ---------------------------------------- */
  --teal-50: oklch(0.97 0.02 var(--accent-hue));
  --teal-100: oklch(0.94 0.03 var(--accent-hue));
  --teal-200: oklch(0.88 0.05 var(--accent-hue));
  --teal-300: oklch(0.78 0.07 var(--accent-hue));
  --teal-400: oklch(0.65 0.09 var(--accent-hue));
  --teal-500: oklch(0.48 var(--accent-chroma) var(--accent-hue));
  --teal-600: oklch(0.43 var(--accent-chroma) var(--accent-hue));
  --teal-700: oklch(0.37 0.09 var(--accent-hue));
  --teal-800: oklch(0.3 0.07 var(--accent-hue));
  --teal-900: oklch(0.22 0.05 var(--accent-hue));

  /* Interactive accent — focus, selection, primary actions */
  --interactive: oklch(0.48 var(--accent-chroma) var(--accent-hue));
  --interactive-hover: oklch(0.43 var(--accent-chroma) var(--accent-hue));
  --interactive-muted: oklch(
    0.55 calc(var(--accent-chroma) * 0.5) var(--accent-hue)
  );
  --interactive-bg: oklch(0.96 0.025 var(--accent-hue));
  --interactive-bg-hover: oklch(0.93 0.03 var(--accent-hue));

  /* Semantic border tokens */
  --interactive-border: var(--teal-300);
  --interactive-border-subtle: var(--teal-200);
  --interactive-border-strong: var(--teal-500);

  /* Semantic text tokens */
  --interactive-text-on-bg: var(--teal-700);
  --interactive-text-subtle: var(--teal-400);

  /* Disabled states */
  --interactive-disabled: var(--teal-300);
  --interactive-disabled-bg: var(--teal-50);

  /* Focus ring */
  --focus-ring: oklch(0.6 0.1 var(--accent-hue));
  --focus-ring-offset: oklch(1 0 0);

  /* Selection highlight */
  --selection-bg: oklch(0.92 0.04 var(--accent-hue));

  /* Warning semantic color */
  --warning: oklch(0.8 0.14 85);

  /* Status indicators */
  --indicator-dirty: oklch(0.62 0.12 44);
  --indicator-clean: var(--interactive);

  /* ----------------------------------------
     SHADCN BASE TOKEN OVERRIDES
     ----------------------------------------
     Warm Nordic palette: stone/birch/charcoal
     tones replace the default neutral grays.
     ---------------------------------------- */
  --background: oklch(0.985 0.004 82);
  --foreground: oklch(0.25 0.012 66);
  --card: oklch(0.985 0.004 82);
  --card-foreground: oklch(0.25 0.012 66);
  --popover: oklch(0.99 0.003 82);
  --popover-foreground: oklch(0.25 0.012 66);
  --secondary: oklch(0.965 0.008 82);
  --secondary-foreground: oklch(0.25 0.012 66);
  --muted: oklch(0.965 0.008 82);
  --muted-foreground: oklch(0.55 0.01 64);
  --border: oklch(0.92 0.008 80);
  --input: oklch(0.92 0.008 80);
  --ring: var(--focus-ring);
  --sidebar: oklch(0.985 0.004 82);
  --sidebar-foreground: oklch(0.25 0.012 66);
  --sidebar-primary: var(--teal-500);
  --sidebar-primary-foreground: oklch(1 0 0);
  --sidebar-accent: oklch(0.965 0.008 82);
  --sidebar-accent-foreground: oklch(0.25 0.012 66);
  --sidebar-border: oklch(0.94 0.006 82);
  --sidebar-ring: var(--focus-ring);
  --background-surface-2: oklch(0.965 0.008 82);
  --background-surface-3: oklch(0.94 0.012 80);
  --foreground-tertiary: oklch(0.62 0.008 64);
  --border-strong: oklch(0.86 0.01 78);
  --border-subtle: oklch(0.95 0.005 82);
  --accent-hover: oklch(0.94 0.01 82);

  /* Shadcn token remapping to spruce accent */
  --primary: var(--teal-500);
  --primary-foreground: oklch(1 0 0);
  --accent: var(--teal-100);
  --accent-foreground: var(--teal-700);

  /* ----------------------------------------
     SCROLLBAR
     ---------------------------------------- */
  --scrollbar-width: 5px;
  --scrollbar-thumb: oklch(0.89 0.008 80);
  --scrollbar-thumb-hover: oklch(0.83 0.01 78);

  /* ----------------------------------------
     DEPTH SYSTEM
     ----------------------------------------
     Warm-tinted shadows for cohesion.
     ---------------------------------------- */
  --shadow-color: oklch(0.25 0.01 66);

  --shadow-xs: 0 1px 2px
    color-mix(in oklch, var(--shadow-color) 5%, transparent);
  --shadow-sm:
    0 1px 3px color-mix(in oklch, var(--shadow-color) 7%, transparent),
    0 1px 2px color-mix(in oklch, var(--shadow-color) 5%, transparent);
  --shadow-md:
    0 4px 6px -1px color-mix(in oklch, var(--shadow-color) 7%, transparent),
    0 2px 4px -2px color-mix(in oklch, var(--shadow-color) 5%, transparent);
  --shadow-lg:
    0 10px 15px -3px color-mix(in oklch, var(--shadow-color) 7%, transparent),
    0 4px 6px -4px color-mix(in oklch, var(--shadow-color) 5%, transparent);

  /* ----------------------------------------
     SPACING SCALE
     ----------------------------------------
     4px base unit for consistent rhythm.
     ---------------------------------------- */
  --space-0: 0;
  --space-0-5: 0.125rem; /* 2px */
  --space-1: 0.25rem; /* 4px */
  --space-1-5: 0.375rem; /* 6px */
  --space-2: 0.5rem; /* 8px */
  --space-2-5: 0.625rem; /* 10px */
  --space-3: 0.75rem; /* 12px */
  --space-4: 1rem; /* 16px */
  --space-5: 1.25rem; /* 20px */
  --space-6: 1.5rem; /* 24px */
  --space-8: 2rem; /* 32px */
  --space-10: 2.5rem; /* 40px */
  --space-12: 3rem; /* 48px */

  /* ----------------------------------------
     TYPOGRAPHY SCALE
     ---------------------------------------- */
  --text-xs: 0.6875rem; /* 11px - status bar, badges, section headers */
  --text-sm: 0.8125rem; /* 13px - secondary text, descriptions */
  --text-base: 0.875rem; /* 14px - body text, list items */
  --text-md: 0.9375rem; /* 15px - emphasized body */
  --text-lg: 1rem; /* 16px - primary content */

  /* ----------------------------------------
     COMPONENT DIMENSIONS
     ---------------------------------------- */
  --size-icon-xs: 0.75rem; /* 12px */
  --size-icon-sm: 0.875rem; /* 14px */
  --size-icon: 1rem; /* 16px */
  --size-icon-md: 1.25rem; /* 20px */
  --size-icon-lg: 1.5rem; /* 24px */

  --size-touch-xs: 1.5rem; /* 24px - minimum touch */
  --size-touch-sm: 1.75rem; /* 28px */
  --size-touch: 2rem; /* 32px - default touch target */
  --size-touch-md: 2.25rem; /* 36px */
  --size-touch-lg: 2.5rem; /* 40px */

  --size-activity-bar: 2.75rem; /* 44px */
  --size-activity-icon: 1.25rem; /* 20px */
  --size-status-bar: 1.625rem; /* 26px — slightly taller to match mockup */
  --size-tree-row: 1.875rem; /* 30px */

  --size-dialog-sm: 24rem;
  --size-dialog-md: 28rem;
  --size-dialog-lg: 32rem;
  --size-dialog-xl: 40rem;
  --size-dialog-list-height: 20rem;
  --size-dialog-list-height-lg: 28rem;

  --size-tree-indent: 1rem;
  --size-tree-base-padding: 0.5rem;

  /* Editor dimensions — refined Nordic sizing */
  --editor-heading-1: 1.75em;
  --editor-heading-2: 1.1875em;
  --editor-heading-3: 1.125em;
  --editor-heading-4: 1.0625em;
  --editor-heading-5: 1em;
  --editor-heading-6: 0.875em;
  --editor-bullet-size: 4px;
  --editor-bullet-nested-size: 3px;
  --editor-checkbox-size: 14px;
  --editor-checkmark-width: 4px;
  --editor-checkmark-height: 7px;
  --editor-checkmark-stroke: 2px;
  --editor-checkmark-offset: -1px;

  /* ----------------------------------------
     TRANSITION SYSTEM
     ---------------------------------------- */
  --duration-fast: 100ms;
  --duration-normal: 150ms;
  --duration-slow: 200ms;
  --duration-slower: 300ms;

  --ease-default: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-in: cubic-bezier(0.4, 0, 1, 1);
  --ease-out: cubic-bezier(0, 0, 0.2, 1);
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);

  /* ----------------------------------------
     BORDER SYSTEM
     ---------------------------------------- */
  --border-width-default: 1px;
  --border-width-thick: 2px;

  /* ----------------------------------------
     Z-INDEX SCALE
     ---------------------------------------- */
  --z-base: 0;
  --z-dropdown: 10;
  --z-sticky: 20;
  --z-overlay: 30;
  --z-modal: 40;
  --z-popover: 50;
  --z-tooltip: 60;
}

[data-color-scheme="dark"] {
  /* Inverted spruce scale for dark mode */
  --teal-50: oklch(0.22 0.04 var(--accent-hue));
  --teal-100: oklch(0.26 0.05 var(--accent-hue));
  --teal-200: oklch(0.32 0.06 var(--accent-hue));
  --teal-300: oklch(0.42 0.07 var(--accent-hue));
  --teal-400: oklch(0.55 0.09 var(--accent-hue));
  --teal-500: oklch(0.68 var(--accent-chroma) var(--accent-hue));
  --teal-600: oklch(0.73 var(--accent-chroma) var(--accent-hue));
  --teal-700: oklch(0.8 0.09 var(--accent-hue));
  --teal-800: oklch(0.88 0.06 var(--accent-hue));
  --teal-900: oklch(0.95 0.03 var(--accent-hue));

  /* Adjusted interactive colors for dark mode */
  --interactive: oklch(0.68 var(--accent-chroma) var(--accent-hue));
  --interactive-hover: oklch(0.73 var(--accent-chroma) var(--accent-hue));
  --interactive-muted: oklch(
    0.62 calc(var(--accent-chroma) * 0.6) var(--accent-hue)
  );
  --interactive-bg: oklch(0.24 0.035 var(--accent-hue));
  --interactive-bg-hover: oklch(0.28 0.04 var(--accent-hue));

  /* Inverted semantic tokens */
  --interactive-text-on-bg: var(--teal-800);
  --interactive-border: var(--teal-400);
  --interactive-border-subtle: var(--teal-300);
  --interactive-border-strong: var(--teal-500);
  --interactive-disabled: var(--teal-400);
  --interactive-disabled-bg: var(--teal-100);

  --focus-ring: oklch(0.68 0.11 var(--accent-hue));
  --focus-ring-offset: oklch(0.175 0 0);

  --selection-bg: oklch(0.28 0.05 var(--accent-hue));

  --warning: oklch(0.86 0.12 90);

  /* ----------------------------------------
     SHADCN BASE TOKEN OVERRIDES — Dark
     ----------------------------------------
     Warm dark palette: deep charcoal tones
     with subtle warmth replacing cold grays.
     ---------------------------------------- */
  --background: oklch(0.18 0.008 68);
  --foreground: oklch(0.92 0.008 78);
  --card: oklch(0.22 0.008 68);
  --card-foreground: oklch(0.92 0.008 78);
  --popover: oklch(0.22 0.008 68);
  --popover-foreground: oklch(0.92 0.008 78);
  --secondary: oklch(0.265 0.008 68);
  --secondary-foreground: oklch(0.92 0.008 78);
  --muted: oklch(0.265 0.008 68);
  --muted-foreground: oklch(0.58 0.008 70);
  --border: oklch(0.31 0.006 68);
  --input: oklch(0.33 0.006 68);
  --ring: var(--focus-ring);
  --sidebar: oklch(0.19 0.008 68);
  --sidebar-foreground: oklch(0.92 0.008 78);
  --sidebar-primary: var(--teal-500);
  --sidebar-primary-foreground: oklch(0.1 0 0);
  --sidebar-accent: oklch(0.265 0.008 68);
  --sidebar-accent-foreground: oklch(0.92 0.008 78);
  --sidebar-border: oklch(0.28 0.006 68);
  --sidebar-ring: var(--focus-ring);
  --background-surface-2: oklch(0.225 0.008 68);
  --background-surface-3: oklch(0.255 0.008 68);
  --foreground-tertiary: oklch(0.55 0.008 68);
  --border-strong: oklch(0.38 0.006 68);
  --border-subtle: oklch(0.225 0.005 68);
  --accent-hover: oklch(0.3 0.008 68);

  /* Shadcn token remapping for dark mode */
  --primary: var(--teal-500);
  --primary-foreground: oklch(0.1 0 0);
  --accent: var(--teal-200);
  --accent-foreground: var(--teal-800);

  /* Scrollbar dark */
  --scrollbar-thumb: oklch(0.33 0.006 68);
  --scrollbar-thumb-hover: oklch(0.4 0.006 68);

  /* Shadows more subtle in dark mode */
  --shadow-color: oklch(0.05 0 0);

  --indicator-dirty: oklch(0.7 0.1 44);
  --indicator-clean: var(--interactive);
}

/* ============================================
   TAILWIND THEME EXTENSION
   ============================================ */

@theme inline {
  /* Font family */
  --font-sans: "Inter", system-ui, -apple-system, sans-serif;
  --font-mono:
    "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    monospace;

  /* Interactive colors */
  --color-interactive: var(--interactive);
  --color-interactive-hover: var(--interactive-hover);
  --color-interactive-muted: var(--interactive-muted);
  --color-interactive-bg: var(--interactive-bg);
  --color-interactive-bg-hover: var(--interactive-bg-hover);

  /* Focus */
  --color-focus-ring: var(--focus-ring);

  /* Selection */
  --color-selection-bg: var(--selection-bg);

  /* Shadows */
  --shadow-xs: var(--shadow-xs);
  --shadow-sm: var(--shadow-sm);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);

  /* Spruce scale */
  --color-teal-50: var(--teal-50);
  --color-teal-100: var(--teal-100);
  --color-teal-200: var(--teal-200);
  --color-teal-300: var(--teal-300);
  --color-teal-400: var(--teal-400);
  --color-teal-500: var(--teal-500);
  --color-teal-600: var(--teal-600);
  --color-teal-700: var(--teal-700);
  --color-teal-800: var(--teal-800);
  --color-teal-900: var(--teal-900);
}

/* ============================================
   GLOBAL OVERRIDES
   ============================================ */

@layer base {
  body {
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Focus ring uses spruce accent */
  *:focus-visible {
    outline: 2px solid var(--focus-ring);
    outline-offset: 2px;
  }

  /* Text selection uses spruce tint */
  ::selection {
    background: var(--selection-bg);
  }

  /* Refined scrollbar — thin, warm-tinted */
  ::-webkit-scrollbar {
    width: var(--scrollbar-width);
    height: var(--scrollbar-width);
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover);
  }

  /* Firefox scrollbar */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--scrollbar-thumb) transparent;
  }
}

/* ============================================
   UTILITY CLASSES
   ============================================ */

@layer utilities {
  /* Interactive background states */
  .bg-interactive {
    background-color: var(--interactive-bg);
  }

  .bg-interactive-hover {
    background-color: var(--interactive-bg-hover);
  }

  /* Active/selected states with accent */
  .is-active {
    background-color: var(--interactive-bg);
    color: var(--interactive);
  }

  .is-active-subtle {
    background-color: color-mix(
      in oklch,
      var(--interactive-bg) 50%,
      transparent
    );
  }

  /* Focus ring utility */
  .focus-ring-interactive {
    &:focus-visible {
      outline-color: var(--focus-ring);
    }
  }

  /* Indicator line (for active states like activity bar) */
  .has-indicator {
    position: relative;

    &::before {
      content: "";
      position: absolute;
      inset-block: var(--space-2);
      inset-inline-start: 0;
      width: 2px;
      background-color: var(--interactive);
      border-radius: 1px;
      opacity: 0;
      transition: opacity var(--duration-fast) var(--ease-default);
    }

    &[data-active="true"]::before,
    &.is-active::before {
      opacity: 1;
    }
  }
}
