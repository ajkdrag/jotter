/* ============================================
   EDITOR DESIGN TOKENS
   ============================================ */

:root {
  /* Runtime-configurable tokens (modified via settings) */
  --editor-font-size: 1rem;
  --editor-line-height: 1.85;
  --editor-max-width: min(85ch, 90%);
  --editor-spacing: 1.5rem;
  --editor-heading-color: var(--foreground);

  /* Body text — warm gray, softer than foreground for comfortable reading */
  --editor-text: oklch(0.46 0.01 55);
  --editor-text-muted: var(--muted-foreground);
  --editor-code-bg: var(--muted);
  --editor-code-text: var(--foreground);
  --editor-code-inline-bg: var(--background-surface-3);
  --editor-code-inline-border: var(--border);
  --editor-blockquote-border: var(--border-strong);
  --editor-blockquote-bg: color-mix(in oklch, var(--muted) 40%, transparent);
  --editor-link: var(--primary);
  --editor-link-underline: color-mix(in oklch, var(--primary) 25%, transparent);
  --editor-link-underline-hover: color-mix(
    in oklch,
    var(--primary) 55%,
    transparent
  );
  --editor-table-border: var(--border);
  --editor-table-header-bg: var(--background-surface-2);
  --editor-table-stripe: color-mix(in oklch, var(--muted) 25%, transparent);
  --editor-selection-bg: color-mix(in oklch, var(--primary) 20%, transparent);
  --editor-hr-gradient-start: transparent;
  --editor-hr-gradient-mid: var(--border-strong);
  --editor-hr-gradient-end: transparent;
  --editor-mark-bg: oklch(0.95 0.08 100);
  --editor-mark-text: oklch(0.35 0.08 100);

  /* Find-in-file match highlighting */
  --editor-find-match-bg: oklch(0.93 0.09 90);
  --editor-find-match-selected-bg: oklch(0.82 0.15 75);

  /* Syntax highlighting — warm Nordic palette */
  --syntax-comment: oklch(0.58 0.01 55);
  --syntax-punctuation: oklch(0.48 0.02 55);
  --syntax-property: oklch(0.45 0.07 200);
  --syntax-selector: oklch(0.42 0.1 155);
  --syntax-operator: oklch(0.48 0.06 55);
  --syntax-keyword: oklch(0.45 0.08 280);
  --syntax-function: oklch(0.42 0.09 200);
  --syntax-variable: oklch(0.42 0.07 25);
  --syntax-string: oklch(0.42 0.1 155);
  --syntax-number: oklch(0.48 0.1 155);
  --syntax-boolean: oklch(0.45 0.08 280);
  --syntax-constant: oklch(0.42 0.08 25);
  --syntax-class: oklch(0.45 0.08 65);
  --syntax-tag: oklch(0.45 0.1 340);
  --syntax-attr-name: oklch(0.45 0.08 65);
  --syntax-attr-value: oklch(0.42 0.1 155);
  --syntax-namespace: oklch(0.48 0.06 65);
  --syntax-regex: oklch(0.42 0.1 340);
  --syntax-important: oklch(0.42 0.1 25);
  --syntax-deleted: oklch(0.48 0.1 25);
  --syntax-inserted: oklch(0.42 0.1 155);
}

.dark {
  --editor-text: oklch(0.775 0.01 72);
  --editor-code-inline-bg: var(--background-surface-3);
  --editor-blockquote-bg: color-mix(in oklch, var(--muted) 30%, transparent);
  --editor-mark-bg: oklch(0.35 0.1 85);
  --editor-mark-text: oklch(0.85 0.08 85);

  /* Find-in-file match highlighting — dark mode */
  --editor-find-match-bg: oklch(0.38 0.08 80);
  --editor-find-match-selected-bg: oklch(0.52 0.14 75);

  /* Syntax highlighting — dark mode warm tones */
  --syntax-comment: oklch(0.55 0.01 55);
  --syntax-punctuation: oklch(0.62 0.02 55);
  --syntax-property: oklch(0.72 0.07 200);
  --syntax-selector: oklch(0.72 0.1 155);
  --syntax-operator: oklch(0.7 0.06 55);
  --syntax-keyword: oklch(0.72 0.08 280);
  --syntax-function: oklch(0.76 0.09 200);
  --syntax-variable: oklch(0.78 0.07 40);
  --syntax-string: oklch(0.72 0.1 155);
  --syntax-number: oklch(0.72 0.1 155);
  --syntax-boolean: oklch(0.72 0.08 280);
  --syntax-constant: oklch(0.78 0.08 40);
  --syntax-class: oklch(0.78 0.08 80);
  --syntax-tag: oklch(0.72 0.1 340);
  --syntax-attr-name: oklch(0.78 0.08 80);
  --syntax-attr-value: oklch(0.72 0.1 155);
  --syntax-namespace: oklch(0.78 0.06 80);
  --syntax-regex: oklch(0.72 0.1 340);
  --syntax-important: oklch(0.78 0.1 25);
  --syntax-deleted: oklch(0.72 0.1 25);
  --syntax-inserted: oklch(0.72 0.1 155);
}

/* ============================================
   MILKDOWN CONTAINER
   ============================================ */

.milkdown {
  position: relative;
}

/* ============================================
   PROSEMIRROR BASE STYLES
   ============================================ */

.ProseMirror {
  font-size: var(--editor-font-size);
  line-height: var(--editor-line-height);
  color: var(--editor-text);
  outline: none;
  max-width: var(--editor-max-width);
  margin: 0 auto;
  padding: var(--space-12) var(--space-8);
  font-feature-settings:
    "liga" 1,
    "calt" 1,
    "kern" 1;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ============================================
   TYPOGRAPHY — HEADINGS
   ============================================
   Sans-serif headings with restrained weight.
   Hierarchy through size and space, not boldness.
   ============================================ */

.ProseMirror h1 {
  font-size: var(--editor-heading-1);
  font-weight: 500;
  line-height: 1.2;
  margin-top: calc(var(--editor-spacing) * 2);
  margin-bottom: var(--editor-spacing);
  color: var(--editor-heading-color);
  letter-spacing: -0.01em;
}

.ProseMirror h1:first-child {
  margin-top: 0;
}

.ProseMirror h2 {
  font-size: var(--editor-heading-2);
  font-weight: 500;
  line-height: 1.3;
  margin-top: calc(var(--editor-spacing) * 1.75);
  margin-bottom: calc(var(--editor-spacing) * 0.85);
  color: var(--editor-heading-color);
  letter-spacing: -0.005em;
}

.ProseMirror h3 {
  font-size: var(--editor-heading-3);
  font-weight: 500;
  line-height: 1.4;
  margin-top: calc(var(--editor-spacing) * 1.5);
  margin-bottom: calc(var(--editor-spacing) * 0.5);
  color: var(--editor-heading-color);
  letter-spacing: -0.005em;
}

.ProseMirror h4 {
  font-size: var(--editor-heading-4);
  font-weight: 500;
  line-height: 1.45;
  margin-top: calc(var(--editor-spacing) * 1.25);
  margin-bottom: calc(var(--editor-spacing) * 0.5);
  color: var(--editor-heading-color);
}

.ProseMirror h5 {
  font-size: var(--editor-heading-5);
  font-weight: 500;
  line-height: 1.55;
  margin-top: calc(var(--editor-spacing) * 1);
  margin-bottom: calc(var(--editor-spacing) * 0.4);
  color: var(--editor-heading-color);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.ProseMirror h6 {
  font-size: var(--editor-heading-6);
  font-weight: 500;
  line-height: 1.6;
  margin-top: calc(var(--editor-spacing) * 0.75);
  margin-bottom: calc(var(--editor-spacing) * 0.4);
  color: var(--editor-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* ============================================
   TYPOGRAPHY — PARAGRAPHS & INLINE
   ============================================ */

.ProseMirror p {
  margin-top: 0;
  margin-bottom: var(--editor-spacing);
}

.ProseMirror strong {
  font-weight: 600;
  color: var(--foreground);
  letter-spacing: -0.01em;
}

.ProseMirror em {
  font-style: italic;
  letter-spacing: 0.005em;
}

.ProseMirror code {
  background: var(--editor-code-inline-bg);
  color: var(--editor-code-text);
  padding: 0.15rem 0.45rem;
  border-radius: calc(var(--radius) * 0.4);
  font-size: 0.88em;
  font-family: var(--font-mono);
  border: 1px solid var(--editor-code-inline-border);
  font-weight: 450;
  letter-spacing: -0.01em;
}

.ProseMirror mark {
  background: var(--editor-mark-bg);
  color: var(--editor-mark-text);
  padding: 0.05em 0.15em;
  border-radius: 2px;
}

.ProseMirror a {
  color: var(--editor-link);
  text-decoration: none;
  border-bottom: 1px solid var(--editor-link-underline);
  transition: border-color var(--duration-normal) var(--ease-default);
}

.ProseMirror a:hover {
  border-bottom-color: var(--editor-link-underline-hover);
}

.ProseMirror a[href$=".md"]::before {
  content: "[[";
  opacity: 0.6;
}

.ProseMirror a[href$=".md"]::after {
  content: "]]";
  opacity: 0.6;
}

/* ============================================
   LISTS
   ============================================ */

.ProseMirror ul,
.ProseMirror ol {
  margin-top: 0;
  margin-bottom: var(--editor-spacing);
  padding-left: var(--space-1);
  list-style: none;
}

.ProseMirror li {
  margin-bottom: var(--space-2);
  line-height: 1.75;
}

.ProseMirror li > p {
  margin-bottom: var(--space-2);
}

.ProseMirror ul ul,
.ProseMirror ol ul,
.ProseMirror ul ol,
.ProseMirror ol ol {
  margin-top: calc(var(--editor-spacing) * 0.35);
  margin-bottom: calc(var(--editor-spacing) * 0.35);
}

/* ============================================
   MILKDOWN LIST ITEM BLOCK COMPONENT
   ============================================ */

.milkdown-list-item-block {
  display: contents;
}

.milkdown-list-item-block > .list-item {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 0.5rem;
}

.milkdown-list-item-block > .list-item > .label-wrapper {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 1rem;
  height: 1.7em;
  user-select: none;
  cursor: default;
}

.milkdown-list-item-block > .list-item > .label-wrapper .label {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0;
  width: 100%;
  height: 100%;
}

.milkdown-list-item-block > .list-item > .label-wrapper .label.bullet::before {
  content: "";
  width: var(--editor-bullet-size);
  height: var(--editor-bullet-size);
  border-radius: 50%;
  background-color: var(--editor-text-muted);
}

.milkdown-list-item-block > .list-item > .label-wrapper .label.ordered {
  font-size: 0.88em;
  font-weight: 500;
  color: var(--editor-text-muted);
  font-feature-settings: "tnum" 1;
}

.milkdown-list-item-block > .list-item > .children {
  flex: 1;
  min-width: 0;
}

.milkdown-list-item-block > .list-item > .children > .content-dom > p {
  margin-bottom: 0;
}

/* Nested list bullets */
.ProseMirror
  ul
  ul
  > .milkdown-list-item-block
  > .list-item
  > .label-wrapper
  .label.bullet::before {
  width: var(--editor-bullet-nested-size);
  height: var(--editor-bullet-nested-size);
  background-color: transparent;
  border: 1.5px solid var(--editor-text-muted);
}

.ProseMirror
  ul
  ul
  ul
  > .milkdown-list-item-block
  > .list-item
  > .label-wrapper
  .label.bullet::before {
  width: var(--editor-bullet-nested-size);
  height: var(--editor-bullet-nested-size);
  border-radius: 1px;
  background-color: var(--editor-text-muted);
  border: none;
}

/* ============================================
   TASK LIST / CHECKBOXES
   ============================================ */

.milkdown-list-item-block > .list-item > .label-wrapper .label.unchecked,
.milkdown-list-item-block > .list-item > .label-wrapper .label.checked {
  cursor: pointer;
  position: relative;
}

.milkdown-list-item-block
  > .list-item
  > .label-wrapper
  .label.unchecked::before {
  content: "";
  width: var(--editor-checkbox-size);
  height: var(--editor-checkbox-size);
  border-radius: 3px;
  background-color: transparent;
  border: 1.5px solid var(--border-strong);
  transition: all 0.15s ease;
}

.milkdown-list-item-block
  > .list-item
  > .label-wrapper
  .label.unchecked:hover::before {
  border-color: var(--primary);
  background-color: color-mix(in oklch, var(--primary) 10%, transparent);
}

.milkdown-list-item-block > .list-item > .label-wrapper .label.checked::before {
  content: "";
  width: var(--editor-checkbox-size);
  height: var(--editor-checkbox-size);
  border-radius: 3px;
  background-color: var(--primary);
  border: 1.5px solid var(--primary);
  transition: all 0.15s ease;
}

.milkdown-list-item-block > .list-item > .label-wrapper .label.checked::after {
  content: "";
  position: absolute;
  width: var(--editor-checkmark-width);
  height: var(--editor-checkmark-height);
  border: solid var(--primary-foreground);
  border-width: 0 var(--editor-checkmark-stroke) var(--editor-checkmark-stroke)
    0;
  transform: rotate(45deg);
  margin-top: var(--editor-checkmark-offset);
}

.milkdown-list-item-block
  > .list-item:has(> .label-wrapper .label.checked)
  > .children {
  color: var(--editor-text-muted);
  text-decoration: line-through;
  text-decoration-color: color-mix(
    in oklch,
    var(--editor-text-muted) 50%,
    transparent
  );
}

/* Child checkboxes inherit checked appearance from parent */
.list-item:has(> .label-wrapper .label.checked) .label.unchecked::before {
  background-color: var(--primary);
  border-color: var(--primary);
}

.list-item:has(> .label-wrapper .label.checked) .label.unchecked::after {
  content: "";
  position: absolute;
  width: var(--editor-checkmark-width);
  height: var(--editor-checkmark-height);
  border: solid var(--primary-foreground);
  border-width: 0 var(--editor-checkmark-stroke) var(--editor-checkmark-stroke)
    0;
  transform: rotate(45deg);
  margin-top: var(--editor-checkmark-offset);
}

/* ============================================
   BLOCKQUOTES
   ============================================ */

.ProseMirror blockquote {
  margin-top: 0;
  margin-bottom: calc(var(--editor-spacing) * 1.25);
  margin-left: calc(var(--editor-spacing) * 0.5);
  padding: calc(var(--editor-spacing) * 0.75) calc(var(--editor-spacing) * 1);
  border-left: 2px solid var(--editor-blockquote-border);
  background: var(--editor-blockquote-bg);
  border-radius: 0 calc(var(--radius) * 0.5) calc(var(--radius) * 0.5) 0;
  color: var(--editor-text-muted);
  font-style: italic;
  letter-spacing: 0.01em;
}

.ProseMirror blockquote > p:last-child {
  margin-bottom: 0;
}

.ProseMirror blockquote > p:first-child {
  margin-top: 0;
}

/* ============================================
   CODE BLOCKS
   ============================================ */

.ProseMirror pre {
  background: var(--editor-code-bg);
  color: var(--editor-code-text);
  border-radius: calc(var(--radius) * 0.75);
  padding: calc(var(--editor-spacing) * 1);
  margin-top: calc(var(--editor-spacing) * 0.75);
  margin-bottom: calc(var(--editor-spacing) * 1.25);
  overflow-x: auto;
  font-family: var(--font-mono);
  font-size: 0.8125em;
  line-height: 1.65;
  border: 1px solid var(--border);
  font-weight: 400;
  letter-spacing: -0.01em;
  position: relative;
}

.ProseMirror pre code {
  background: transparent;
  padding: 0;
  border-radius: 0;
  font-size: inherit;
  color: inherit;
  border: none;
  font-weight: inherit;
}

/* ============================================
   SYNTAX HIGHLIGHTING (PRISM)
   ============================================ */

/* Comments and documentation */
.ProseMirror .token.comment,
.ProseMirror .token.prolog,
.ProseMirror .token.doctype,
.ProseMirror .token.cdata {
  color: var(--syntax-comment);
  font-style: italic;
}

/* Punctuation */
.ProseMirror .token.punctuation {
  color: var(--syntax-punctuation);
}

/* Properties and definitions */
.ProseMirror .token.property,
.ProseMirror .token.tag,
.ProseMirror .token.boolean,
.ProseMirror .token.number,
.ProseMirror .token.constant,
.ProseMirror .token.symbol {
  color: var(--syntax-property);
}

/* Selectors, attributes, strings */
.ProseMirror .token.selector,
.ProseMirror .token.attr-name,
.ProseMirror .token.string,
.ProseMirror .token.char,
.ProseMirror .token.builtin {
  color: var(--syntax-string);
}

/* Operators and entities */
.ProseMirror .token.operator,
.ProseMirror .token.entity,
.ProseMirror .token.url,
.ProseMirror .language-css .token.string,
.ProseMirror .style .token.string {
  color: var(--syntax-operator);
}

/* Keywords and control flow */
.ProseMirror .token.keyword,
.ProseMirror .token.control,
.ProseMirror .token.directive,
.ProseMirror .token.unit,
.ProseMirror .token.statement,
.ProseMirror .token.regex,
.ProseMirror .token.atrule {
  color: var(--syntax-keyword);
}

/* Functions and methods */
.ProseMirror .token.function,
.ProseMirror .token.method,
.ProseMirror .token.function-name {
  color: var(--syntax-function);
}

/* Variables and parameters */
.ProseMirror .token.variable,
.ProseMirror .token.parameter,
.ProseMirror .token.attr-value {
  color: var(--syntax-variable);
}

/* Classes and types */
.ProseMirror .token.class-name,
.ProseMirror .token.type-class,
.ProseMirror .token.class {
  color: var(--syntax-class);
}

/* Numbers and boolean literals */
.ProseMirror .token.number,
.ProseMirror .token.hexcode {
  color: var(--syntax-number);
}

.ProseMirror .token.boolean {
  color: var(--syntax-boolean);
}

/* Constants and enums */
.ProseMirror .token.constant {
  color: var(--syntax-constant);
}

/* HTML/XML tags */
.ProseMirror .token.tag {
  color: var(--syntax-tag);
}

/* Namespaces and modules */
.ProseMirror .token.namespace,
.ProseMirror .token.module {
  color: var(--syntax-namespace);
}

/* Regular expressions */
.ProseMirror .token.regex {
  color: var(--syntax-regex);
}

/* Important and deleted text */
.ProseMirror .token.important,
.ProseMirror .token.bold {
  font-weight: 600;
  color: var(--syntax-important);
}

.ProseMirror .token.deleted {
  color: var(--syntax-deleted);
}

.ProseMirror .token.inserted {
  color: var(--syntax-inserted);
}

/* Italic tokens */
.ProseMirror .token.italic {
  font-style: italic;
}

/* Ensure tokens don't have background */
.ProseMirror .token {
  background: transparent;
}

/* ============================================
   HORIZONTAL RULES
   ============================================ */

.ProseMirror hr {
  border: none;
  height: 1px;
  background: linear-gradient(
    90deg,
    var(--editor-hr-gradient-start),
    var(--editor-hr-gradient-mid) 50%,
    var(--editor-hr-gradient-end)
  );
  margin-top: calc(var(--editor-spacing) * 2.5);
  margin-bottom: calc(var(--editor-spacing) * 2.5);
  opacity: 0.5;
}

/* ============================================
   TABLES
   ============================================ */

.ProseMirror table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-top: calc(var(--editor-spacing) * 0.75);
  margin-bottom: calc(var(--editor-spacing) * 1.25);
  overflow: hidden;
  border-radius: calc(var(--radius) * 0.75);
  border: 1px solid var(--editor-table-border);
  font-size: 0.95em;
}

.ProseMirror th,
.ProseMirror td {
  padding: calc(var(--editor-spacing) * 0.65) calc(var(--editor-spacing) * 0.85);
  border-bottom: 1px solid var(--editor-table-border);
  border-right: 1px solid var(--editor-table-border);
  text-align: left;
  line-height: 1.5;
}

.ProseMirror th:last-child,
.ProseMirror td:last-child {
  border-right: none;
}

.ProseMirror th {
  background: var(--editor-table-header-bg);
  font-weight: 500;
  color: var(--editor-text);
  font-size: 0.875em;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-feature-settings: "tnum" 1;
}

.ProseMirror tbody tr:last-child td {
  border-bottom: none;
}

.ProseMirror tbody tr:nth-child(even) td {
  background: var(--editor-table-stripe);
}

.ProseMirror tbody tr:hover td {
  background: color-mix(in oklch, var(--muted) 35%, transparent);
  transition: background var(--duration-fast) var(--ease-default);
}

/* ============================================
   IMAGES
   ============================================ */

.ProseMirror img {
  max-width: 100%;
  height: auto;
  border-radius: calc(var(--radius) * 0.75);
  border: 1px solid var(--border);
}

/* ============================================
   MILKDOWN IMAGE BLOCK COMPONENT
   ============================================ */

.ProseMirror .milkdown-image-block {
  outline: none;
  margin: calc(var(--editor-spacing) * 0.75) 0;
  display: block;
}

.ProseMirror .milkdown-image-block.selected > .image-edit,
.ProseMirror .milkdown-image-block.selected > .image-wrapper img {
  outline: 2px solid var(--ring);
  outline-offset: 2px;
}

.ProseMirror .milkdown-image-block > .image-wrapper {
  position: relative;
  width: fit-content;
  margin: 0 auto;
  min-width: 100px;
}

.ProseMirror .milkdown-image-block > .image-wrapper .operation {
  position: absolute;
  display: flex;
  gap: 0.5rem;
  right: 0.5rem;
  top: 0.5rem;
  opacity: 0;
  transition: opacity var(--duration-normal) var(--ease-default);
}

.ProseMirror .milkdown-image-block:hover > .image-wrapper .operation {
  opacity: 1;
}

.ProseMirror
  .milkdown-image-block
  > .image-wrapper
  .operation
  > .operation-item {
  color: var(--primary-foreground);
  padding: 0.5rem;
  background: color-mix(in oklch, var(--foreground) 40%, transparent);
  border-radius: calc(var(--radius) * 0.5);
  height: 1.75rem;
  width: 1.75rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.ProseMirror .milkdown-image-block > .image-wrapper .image-resize-handle {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  height: 0.5rem;
  bottom: -0.25rem;
  width: 10rem;
  background: var(--border);
  border-radius: 2px;
  opacity: 0;
  transition: opacity var(--duration-normal) var(--ease-default);
  cursor: row-resize;
}

.ProseMirror .milkdown-image-block:hover > .image-wrapper .image-resize-handle {
  opacity: 1;
}

.ProseMirror .milkdown-image-block > .image-wrapper img {
  max-width: 100%;
  min-height: 100px;
  display: block;
  object-fit: cover;
  margin: 0;
}

.ProseMirror .milkdown-image-block > .caption-input {
  display: block;
  width: 100%;
  margin: calc(var(--editor-spacing) * 0.5) auto;
  padding: 0.25rem 0;
  text-align: center;
  font-size: var(--editor-font-size);
  color: var(--editor-text-muted);
  background: transparent;
  border: none;
  outline: none;
}

.ProseMirror .milkdown-image-block > .image-edit {
  display: flex;
  align-items: center;
  padding: calc(var(--editor-spacing) * 0.75) calc(var(--editor-spacing) * 1);
  gap: 0.75rem;
  background: var(--muted);
  border-radius: calc(var(--radius) * 0.75);
  min-height: 3.5rem;
  border: 1px dashed var(--border);
}

.ProseMirror .milkdown-image-block > .image-edit .image-icon {
  color: var(--muted-foreground);
  flex-shrink: 0;
}

.ProseMirror .milkdown-image-block > .image-edit .link-importer .placeholder {
  color: var(--muted-foreground);
}

.ProseMirror
  .milkdown-image-block
  > .image-edit
  .link-importer
  .link-input-area {
  line-height: 1.5;
  padding: 0.25rem 0;
  width: 100%;
  background: transparent;
  border: none;
  outline: none;
  color: var(--foreground);
}

.ProseMirror .milkdown-image-block > .image-edit .confirm {
  background: var(--primary);
  color: var(--primary-foreground);
  padding: 0.25rem 1rem;
  border-radius: calc(var(--radius) * 0.5);
  font-size: 0.875rem;
  cursor: pointer;
  border: none;
}

.ProseMirror .milkdown-image-block .hidden {
  display: none !important;
}

/* ============================================
   SELECTION
   ============================================ */

.ProseMirror ::selection {
  background: var(--editor-selection-bg);
  color: var(--foreground);
}

/* ============================================
   FIND-IN-FILE MATCH HIGHLIGHTING
   ============================================ */

.ProseMirror .find-match {
  background-color: var(--editor-find-match-bg);
  border-radius: 2px;
  box-shadow: 0 0 0 1px
    color-mix(in oklch, var(--editor-find-match-bg) 60%, transparent);
  transition: background-color var(--duration-fast) var(--ease-default);
}

.ProseMirror .find-match--selected {
  background-color: var(--editor-find-match-selected-bg);
  box-shadow: 0 0 0 1px
    color-mix(in oklch, var(--editor-find-match-selected-bg) 80%, transparent);
}

/* ============================================
   PLACEHOLDER
   ============================================ */

.ProseMirror p.is-empty:first-child::before {
  content: attr(data-placeholder);
  color: var(--editor-text-muted);
  opacity: 0.4;
  pointer-events: none;
  position: absolute;
  font-style: italic;
  letter-spacing: 0.01em;
}

/* ============================================
   EDITOR FOCUS
   ============================================ */

.ProseMirror:focus {
  outline: none;
}

/* ============================================
   LINK TOOLTIP COMPONENT
   ============================================ */

.milkdown-link-preview {
  position: absolute;
  z-index: 50;
  overflow: hidden;
  border-radius: calc(var(--radius) * 0.5);
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border);
  background: var(--popover);
}

.milkdown-link-preview[data-show="false"] {
  display: none;
}

.milkdown-link-preview > .link-preview {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 0.75rem;
  cursor: default;
  min-height: 2.25rem;
  background: var(--popover);
}

.milkdown-link-preview > .link-preview > .link-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--muted-foreground);
  flex-shrink: 0;
}

.milkdown-link-preview > .link-preview > .link-icon svg {
  width: 1rem;
  height: 1rem;
}

.milkdown-link-preview > .link-preview > .link-display {
  max-width: 280px;
  line-height: 1.4;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--text-sm);
  color: var(--editor-link);
  pointer-events: none;
  cursor: default;
}

.milkdown-link-preview > .link-preview > .button {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.25rem;
  border-radius: calc(var(--radius) * 0.35);
  color: var(--muted-foreground);
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-default);
  flex-shrink: 0;
}

.milkdown-link-preview > .link-preview > .button svg {
  width: 0.875rem;
  height: 0.875rem;
}

.milkdown-link-preview > .link-preview > .button:hover {
  background: var(--accent);
  color: var(--accent-foreground);
}

.milkdown-link-edit {
  position: absolute;
  z-index: 50;
  overflow: hidden;
  border-radius: calc(var(--radius) * 0.5);
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border);
  background: var(--popover);
}

.milkdown-link-edit[data-show="false"] {
  display: none;
}

.milkdown-link-edit > .link-edit {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 0.75rem;
  min-height: 2.25rem;
  background: var(--popover);
}

.milkdown-link-edit > .link-edit > .input-area {
  outline: none;
  background: transparent;
  width: 16rem;
  font-size: var(--text-sm);
  color: var(--foreground);
  border: none;
}

.milkdown-link-edit > .link-edit > .input-area::placeholder {
  color: var(--muted-foreground);
}

.milkdown-link-edit > .link-edit > .button {
  cursor: pointer;
  border-radius: calc(var(--radius) * 0.35);
  font-size: var(--text-sm);
  padding: 0.25rem 0.5rem;
  display: flex;
  align-items: center;
  color: var(--muted-foreground);
  transition: all var(--duration-normal) var(--ease-default);
}

.milkdown-link-edit > .link-edit > .button svg {
  width: 0.875rem;
  height: 0.875rem;
}

.milkdown-link-edit > .link-edit > .button:hover {
  background: var(--accent);
  color: var(--accent-foreground);
}

.milkdown-link-edit > .link-edit > .button.hidden {
  visibility: hidden;
  pointer-events: none;
}

.ProseMirror a {
  cursor: pointer;
  pointer-events: auto;
}

/* ============================================
   WIKI SUGGEST DROPDOWN
   ============================================ */

.WikiSuggest {
  position: absolute;
  z-index: 50;
  min-width: 200px;
  max-width: 320px;
  max-height: 240px;
  overflow-y: auto;
  border-radius: calc(var(--radius) * 0.5);
  border: 1px solid var(--border);
  background: var(--popover);
  box-shadow: var(--shadow-md);
  padding: var(--space-1) 0;
}

.WikiSuggest[data-show="false"] {
  display: none;
}

.WikiSuggest__item {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  justify-content: space-between;
  width: 100%;
  padding: var(--space-1-5) var(--space-2);
  text-align: left;
  font-size: var(--text-sm);
  color: var(--foreground);
  background: transparent;
  border: none;
  cursor: pointer;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  transition: background-color var(--duration-fast) var(--ease-default);
}

.WikiSuggest__label {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.WikiSuggest__item:hover {
  background: var(--muted);
}

.WikiSuggest__item--planned .WikiSuggest__label {
  color: var(--muted-foreground);
}

.WikiSuggest__badge {
  flex-shrink: 0;
  font-size: var(--text-xs);
  color: var(--muted-foreground);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 0 var(--space-1);
}

.WikiSuggest__item--selected {
  background: var(--interactive-bg);
  color: var(--interactive);
}

.WikiSuggest__item--selected .WikiSuggest__badge {
  color: inherit;
  border-color: currentColor;
}
